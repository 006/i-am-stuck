package utils

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

const expired = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjZabHF4NXZXTUtZdDgyaENJT05OQyJ9.eyJpc3MiOiJodHRwczovL2Rldi1tc3gzNng0cGFnOHMyMnczLmNhLmF1dGgwLmNvbS8iLCJzdWIiOiJhdXRoMHw2NzhmYzY5ZTI1OGEzODZkNmFjMjFjZjIiLCJhdWQiOlsiaW8ub25tZS5ub2JpdGVzIiwiaHR0cHM6Ly9kZXYtbXN4MzZ4NHBhZzhzMjJ3My5jYS5hdXRoMC5jb20vdXNlcmluZm8iXSwiaWF0IjoxNzM3ODM4NDQ5LCJleHAiOjE3Mzc5MjQ4NDksInNjb3BlIjoib3BlbmlkIHByb2ZpbGUgZW1haWwgc3BvdCByZXBvcnQiLCJhenAiOiJHdVhBVnpNQlA3NTlhTEg1YjBYbFJlekJVOGVCOFhwZCJ9.p2hX4CoRsd8iWXOxYEBKKaQMbF5o86xo04ThU7pnDRYhoqzZGqpKQe-gWi_wgQGpVYN9wiHE0-UwJ6v9bCfoIS2q2hC088fD1g_xO3GBSOFPxUmSI6vnLHZhT5KriX0eK3LO0r-PTnekRk_nbwHYy8HQli4ZDfStEJnZvBd4bJcsO_pKGw61PjXfqtprd0k0Xv_06rn1jcMsl_vITU07OrpkMUFrN0c1zOjHo5fU9tIasmQcAEPDh2RvJ-U9sV079NmfwNZhg_Z186FeO7GlUtyB8tfZKjs0P_P6lIylS0XQSsgPPHdCvi9DMCitiVHxnO5s27q5LFCDwz5hsz4OPA"
const valid = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjZabHF4NXZXTUtZdDgyaENJT05OQyJ9.eyJpc3MiOiJodHRwczovL2Rldi1tc3gzNng0cGFnOHMyMnczLmNhLmF1dGgwLmNvbS8iLCJzdWIiOiJhdXRoMHw2NzhmYzY5ZTI1OGEzODZkNmFjMjFjZjIiLCJhdWQiOlsiaW8ub25tZS5zdHVjayIsImh0dHBzOi8vZGV2LW1zeDM2eDRwYWc4czIydzMuY2EuYXV0aDAuY29tL3VzZXJpbmZvIl0sImlhdCI6MTc0MTU0MTU2MSwiZXhwIjoxNzQyNDA1NTYxLCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIHNwb3QgcmVwb3J0IGNoYXQiLCJhenAiOiJHdVhBVnpNQlA3NTlhTEg1YjBYbFJlekJVOGVCOFhwZCJ9.Z4VhIJ6bwzinojVyj5GXKTMKgqznSU_Q4noBAfRjMNqofph15sY9hTpP8cydTIzuW871rD6jTWbRPlWXizjld1-05iKghG9kvWFKrKe-kO94fLKi9JN0igeMzKtVOHnhe8ZZeJpkw7bFZtiT8inFJZQzEYDGoglTIVhl6XzJGVqCb72DPncjZgAJrPBRKOLNk8idOhYLQ5GoiC4dI930vikYLH8BZK-TU-IBIJb95jHRviUFJ6Hqy4-Xh3s3h8mw5HlnUldmFF0rsLLUqnF8bFGcFTGhWTovr51aOUDonlTApaJkK7O4OHzAyhcw-VT0011FQRfu61sKFADzy5mmlg"

func TestExample_jwk_fetch(t *testing.T) {
	// assert.Equal(t, false, ValidateJSONWebToken(expired), "expired")

	assert.Equal(t, ValidateResult{Result: true}, ValidateJSONWebToken(valid, "spot"), "valid")

	assert.Equal(t, ValidateResult{Result: false, Err: "scope not granted"}, ValidateJSONWebToken(valid, "spots"), "valid")
}
